# Right now this is just to provide binary sensors to control the conditional cards on our dashboard.
# These are needed in order to prevent cards showing for events that are several months in the future...

input_boolean:
  sports_updates:
    name: Sports Updates
    icon: mdi:strategy

template:
  - binary_sensor:
    - name: Michigan Wolverines Inhibit
      unique_id: f361b30c-1771-41b3-85ff-ef1e0b6be59c
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ sports_inhibit('sensor.michigan_wolverines') }}
    - name: Ohio State Buckeyes Inhibit
      unique_id: d5359cb4-427a-46f8-99d6-4313530fde81
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ state_attr('sensor.ohio_state_buckeyes','opponent_abbr') in ['MICH'] or sports_inhibit('sensor.ohio_state_buckeyes') }}
    - name: Toledo Rockets Inhibit
      unique_id: 1f84d3f3-a06e-4745-a593-c21fe3504072
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ state_attr('sensor.toledo_rockets','opponent_abbr') in ['OSU','MICH'] or sports_inhibit('sensor.toledo_rockets') }}
    - name: Minnesota Vikings Inhibit
      unique_id: ea60c987-a95b-4024-a9c7-1bc6975e07e2
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ sports_inhibit('sensor.minnesota_vikings') }}
    - name: San Francisco 49ers Inhibit
      unique_id: ce2441fa-09d6-4afc-b350-fee3745cdb50
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ state_attr('sensor.toledo_rockets','opponent_abbr') in ['MIN'] or sports_inhibit('sensor.san_francisco_49ers') }}
    - name: Cleveland Guardians Inhibit
      unique_id: b0980d47-d762-4f23-97b1-9e88da729d8f
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ sports_inhibit('sensor.cleveland_guardians') }}
    - name: Minnesota Twins Inhibit
      unique_id: 2987ae95-f55d-4994-b9dd-018278d2f5ad
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ state_attr('sensor.minnesota_twins','opponent_abbr') in ['CLE','LAD'] or sports_inhibit('sensor.minnesota_twins') }}
    - name: Los Angeles Dodgers Inhibit
      unique_id: 2c6aae6e-eff6-46e5-bee9-311f9bbc0c0e
      state: >
        {% from 'sports.jinja' import sports_inhibit %}
        {{ state_attr('sensor.los_angeles_dodgers','opponent_abbr') in ['CLE'] or sports_inhibit('sensor.los_angeles_dodgers') }}

intent_script:
  SportsScore:
    speech:
      text: >
        {% from 'sports.jinja' import sports_pregame, sports_main %}
        {% set inhibit = "binary_sensor." + team + "_inhibit" %}
        {% set sensor = "sensor." + team %}
        {% if is_state(inhibit,'on') %}
          I do not have any information about the {{ state_attr(team,'friendly_name') }} at this time.
        {% elif states(sensor) in ["NOT_FOUND"] %}
          They do not appear to have a game scheduled for today.
        {% else %}
          {{ sports_pregame(sensor) }}
          {{ sports_main(sensor) }}
        {% endif %}
